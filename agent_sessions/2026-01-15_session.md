# Session Notes - 2026-01-15

## Session Focus
Initial design and setup of the Success Library pilot for VVD (Virtual Visa Debit) campaigns.

---

## Key Decisions Made

### 1. Success Library Purpose (Dual Use)
- **Now (no curated layer):** Operational tool - pull code, run it directly
- **Future (curated layer exists):** Reference documentation for pre-calculated metrics
- Code remains valuable for auditability, lineage, onboarding, and debugging

### 2. Architecture - Full Vision

**End-State Vision (searchable interface):**
```
┌─────────────────────────────────────────────────────────┐
│  SUCCESS LIBRARY INTERFACE (future: dashboard/website)  │
│                                                         │
│  Search: [VVD____________]  [Search]                    │
│                                                         │
│  Results:                                               │
│  ┌─────────────────────────────────────────────────┐   │
│  │ VVD_ACQ_001 │ Acquisition Success │ [View Code] │   │
│  │ VVD_ACT_001 │ Activation Success  │ [View Code] │   │
│  │ VVD_USG_001 │ Usage Success       │ [View Code] │   │
│  │ VVD_PRV_001 │ Provisioning Success│ [View Code] │   │
│  └─────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────┘
```

**System Architecture:**
```
┌──────────────────────────────────────────────┐
│         HTML Interface (Frontend)            │
│   - Search by Product / LOB / Metric Type    │
│   - View metadata                            │
│   - Copy/paste code                          │
└──────────────────┬───────────────────────────┘
                   │ pulls from
                   ▼
┌──────────────────────────────────────────────┐
│           GitHub Repo (Backend)              │
│   - Version control                          │
│   - Change history                           │
│   - Governance (PR reviews)                  │
└──────────────────────────────────────────────┘
```

**File Structure:**
```
success_library/
├── metadata/
│   └── success_library_index.json   # Consolidated catalog (ALL metrics, all products)
│
├── code/
│   └── VVD/
│       ├── VVD_ACQ_001.sql
│       ├── VVD_ACT_001.sql
│       ├── VVD_USG_001.sql
│       └── VVD_PRV_001.sql
│
└── index.html                        # Simple HTML interface
```

**Key Design Principle:**
- `metric_id` is the key that links metadata to code
- One consolidated metadata file = the searchable index
- Code files referenced by path from metadata

### 3. Code Language Decision
- **SQL** for the logic (platform agnostic, Snowflake target, broader accessibility)
- **PySpark** for orchestration/wrapper when needed

### 4. Version Control
- Git handles real audit trail (commits, history, diffs)
- Metadata "version" field is manual label (v1.0, v2.0)
- Option D from discussion: Git tags + manual major versions (hybrid)

---

## VVD Campaign Mappings (CORRECTED)

**Do not use the old vvd_config.py mappings - they were incorrect.**

| Campaign | Stage | Success Metric |
|----------|-------|----------------|
| VCN | Acquisition | VVD_ACQ_001 (Acquisition Success) |
| VDA | Acquisition | VVD_ACQ_001 (Acquisition Success) |
| VDT | Activation | VVD_ACT_001 (Activation Success) |
| VUT | Provisioning | VVD_USG_001 (Usage Success) |
| VAW | Provisioning | VVD_PRV_001 (Provisioning Success) |
| VUI | Usage | VVD_PRV_001 (Provisioning Success) |

---

## Metadata Attributes (Final List)

| Attribute | Description |
|-----------|-------------|
| metric_id | Unique key (e.g., VVD_ACQ_001) |
| metric_name | Human-readable name |
| product | VVD, Credit Card, etc. |
| line_of_business | For grouping/filtering |
| metric_type | Acquisition / Activation / Usage / Provisioning |
| pillar | Conversion / Engagement / Retention / etc. |
| business_definition | Plain English description |
| code_path | Link to the SQL file |
| source_tables | Raw/original data (source of truth) |
| staged_source | Curated/pre-calculated layer (empty for pilot) |
| grain | Client / Account / Transaction |
| measurement_window_days | Days post-treatment |
| owner | Who maintains it |
| version | Manual version label |
| campaigns_using | Which campaigns use this metric |

---

## Files Created This Session

```
NBA Souccess Library/
├── index.html                              # HTML interface
├── metadata/
│   └── success_library_index.json          # Consolidated metadata
├── code/
│   └── VVD/
│       ├── VVD_ACQ_001.sql                 # Acquisition Success (placeholder)
│       ├── VVD_ACT_001.sql                 # Activation Success (placeholder)
│       ├── VVD_USG_001.sql                 # Usage Success (placeholder)
│       └── VVD_PRV_001.sql                 # Provisioning Success (placeholder)
└── agent_sessions/
    └── 2026-01-15_session.md               # This file
```

---

## Tech Stack Context (from MD doc)

| Timeline | Platform |
|----------|----------|
| Short Term (Jan) | Teradata Datalab |
| Medium Term (6+ mo) | Spark SQL + Airflow/Dagster |
| Long Term (12+ mo) | Snowflake (primary) |

---

## Pending Improvements / Feedback

### HTML Interface Redesign Required
- **Current:** Card-based layout (repeating metadata blocks for each metric)
- **Requested:** Simple table format with search
- **Reason:** Card layout is verbose, repetitive, not efficient
- **Action:** Redesign to a clean table with columns, click row to expand/view code

### Brainstorm: More Efficient HTML Approach
Ideas to explore next session:
1. **Static HTML generated from JSON** - Script that reads `success_library_index.json` and generates HTML table (no embedded data duplication)
2. **Single source of truth** - HTML fetches JSON at runtime instead of hardcoding data in both places
3. **Minimal JavaScript** - Keep it simple, reduce maintenance burden
4. **Consider:** Is there a simpler approach than custom HTML? (e.g., GitHub Pages with Jekyll, or just render the JSON directly?)

---

## Next Steps (Not Started)

1. **Redesign HTML to table format** (priority - current design rejected)
2. **Fill in business definitions** for each metric
3. **Fill in source tables** for each metric
4. **Write actual SQL logic** for each metric (currently placeholders)
5. **Define measurement windows** (days post-treatment)
6. **Assign owners** for each metric

---

## Important Notes

- User preference: **Do not assume.** Ask questions if unclear.
- User preference: **No praising/glazing.** Be pragmatic and critical.
- The existing `vvd_config.py` in the VVD folder has **incorrect mappings** - do not use as source of truth.
- Dashboard team handoff gap still exists - they use SAS/SQL, cannot read from Hive.

---

## Reference Documents

- `support/success_library_project_context.md` - Full project context
- `/mnt/c/Users/andre/New_projects/VVD/` - Existing VVD code (use for reference, not as source of truth for mappings)

---

*Session ended: 2026-01-15*
